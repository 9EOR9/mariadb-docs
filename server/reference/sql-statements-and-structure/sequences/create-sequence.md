# CREATE SEQUENCE

## Syntax

```
CREATE [OR REPLACE] [TEMPORARY] SEQUENCE [IF NOT EXISTS] sequence_name
[AS { TINYINT | SMALLINT | |MEDIUMINT | INT | INTEGER | BIGINT } [SIGNED | UNSIGNED]]
[ INCREMENT [ BY | = ] number ]
[ MINVALUE [=] number | NO MINVALUE | NOMINVALUE ]
[ MAXVALUE [=] number | NO MAXVALUE | NOMAXVALUE ]
[ START [ WITH | = ] number ] 
[ CACHE [=] number | NOCACHE ] [ CYCLE | NOCYCLE] 
[table_options](../sql-statements/data-definition/create/create-table.md#table-options)
```

The options for `CREATE SEQUENCE` can be given in any order, optionally followed by `table_options`.

_table\_options_ can be any of the normal table options in [CREATE TABLE](../../sql-statements/data-definition/create/create-table.md) but the most usable ones are `ENGINE=...` and `COMMENT=`.

`NOMAXVALUE` and `NOMINVALUE` are there to allow one to create SEQUENCEs using the Oracle syntax.

## Description

CREATE SEQUENCE will create a sequence that generates new\
values when called with `NEXT VALUE FOR sequence_name`. It's an alternative to [AUTO INCREMENT](../../data-types/auto_increment.md) when one wants to have more control of how the numbers are generated. As the SEQUENCE caches values (up to `CACHE`) it can in some cases be much faster than [AUTO INCREMENT](../../data-types/auto_increment.md). Another benefit is that one can access the last value generated by all used sequences, which solves one of the limitations with [LAST\_INSERT\_ID()](../../sql-statements/built-in-functions/secondary-functions/information-functions/last_insert_id.md).

CREATE SEQUENCE requires the [CREATE privilege](../../sql-statements/account-management-sql-commands/grant.md).

[DROP SEQUENCE](drop-sequence.md) can be used to drop a sequence, and [ALTER SEQUENCE](alter-sequence.md) to change it.

### CREATE arguments

The following options may be used:

#### AS

int type, i.e. one of [TINYINT](../../data-types/data-types-numeric-data-types/tinyint.md), [SMALLINT](../../data-types/data-types-numeric-data-types/smallint.md), [MEDIUMINT](../../data-types/data-types-numeric-data-types/mediumint.md), [INT](../../data-types/data-types-numeric-data-types/int.md), [INTEGER](../../data-types/data-types-numeric-data-types/integer.md), [BIGINT](../../data-types/data-types-numeric-data-types/bigint.md). Can be signed or unsigned. Maximum value is based on the data type. The use of BIGINT UNSIGNED with this option extends the possible maximum value from 9223372036854775806 to 18446744073709551614. Default BIGINT. From [MariaDB 11.5](https://app.gitbook.com/s/aEnK0ZXmUbJzqQrTjFyb/mariadb-community-server-release-notes/old-releases/release-notes-mariadb-11-5-rolling-releases/what-is-mariadb-115).

#### INCREMENT

Increment to use for values. May be negative. Setting an increment of 0 causes the sequence to use the value of the [auto\_increment\_increment](../../../ha-and-performance/standard-replication/replication-and-binary-log-system-variables.md) system variable at the time of creation, which is always a positive number. (see [MDEV-16035](https://jira.mariadb.org/browse/MDEV-16035)). Default 1.

#### MINVALUE

Minimum value for the sequence. From [MariaDB 11.5](https://app.gitbook.com/s/aEnK0ZXmUbJzqQrTjFyb/mariadb-community-server-release-notes/old-releases/release-notes-mariadb-11-5-rolling-releases/what-is-mariadb-115), parser permits much smaller numbers, such as -9999999999999999999999999999, but converts to the minimum permitted for the int type, with a note. Default 1 if INCREMENT > 0 and -9223372036854775807 (or based on int type) if INCREMENT < 0.

#### MAXVALUE

|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| Max value for sequence. From [MariaDB 11.5](https://app.gitbook.com/s/aEnK0ZXmUbJzqQrTjFyb/mariadb-community-server-release-notes/old-releases/release-notes-mariadb-11-5-rolling-releases/what-is-mariadb-115), parser permits much larger numbers, such as 9999999999999999999999999999 used in Oracle examples, but converts to the maximum permitted for the int type, with a note. Default 9223372036854775806 (or based on int type) if INCREMENT > 0 and -1 if INCREMENT < 0. |

#### START

First value that the sequence will generate. Default MINVALUE if INCREMENT > 0, and MAX\_VALUE if INCREMENT< 0.

#### CACHE / NOCACHE

Number of values that should be cached. 0 if no CACHE. The underlying table will be updated first time a new sequence number is generated and each time the cache runs out. Default 1000. [FLUSH TABLES](../../sql-statements/administrative-sql-statements/flush-commands/flush.md), shutting down the server, etc. will discard the cached values, and the next sequence number generated will be according to what's stored in the Sequence object. In effect, this will discard the cached values. Note that setting the cache to 1 from 1000, can make inserts to tables using sequences for default values 2x slower and increase the binary log sizes up to 7x.

#### CYCLE / NOCYCLE

If `CYCLE` is used, then the sequence should start again from `MINVALUE` after it has run out of values. Default value is `NOCYCLE`.

### Constraints on Create Arguments

To be able to create a legal sequence, the following must hold:

* MAXVALUE >= start
* MAXVALUE > MINVALUE
* START >= MINVALUE
* MAXVALUE <= 9223372036854775806 (LONGLONG\_MAX-1). From [MariaDB 11.5](https://app.gitbook.com/s/aEnK0ZXmUbJzqQrTjFyb/mariadb-community-server-release-notes/old-releases/release-notes-mariadb-11-5-rolling-releases/what-is-mariadb-115), the parser accepts values beyond this, and converts based on the int type.
* MINVALUE >= -9223372036854775807 (LONGLONG\_MIN+1). From [MariaDB 11.5](https://app.gitbook.com/s/aEnK0ZXmUbJzqQrTjFyb/mariadb-community-server-release-notes/old-releases/release-notes-mariadb-11-5-rolling-releases/what-is-mariadb-115), the parser accepts values beyond this, and converts based on the int type.

Note that sequences can't generate the maximum/minimum 64 bit number because of the constraint of`MINVALUE` and `MAXVALUE`.

### Atomic DDL

**MariaDB starting with** [**10.6.1**](https://app.gitbook.com/s/aEnK0ZXmUbJzqQrTjFyb/mariadb-community-server-release-notes/release-notes-mariadb-10-6-series/mariadb-1061-release-notes)

[MariaDB 10.6.1](https://app.gitbook.com/s/aEnK0ZXmUbJzqQrTjFyb/mariadb-community-server-release-notes/release-notes-mariadb-10-6-series/mariadb-1061-release-notes) supports [Atomic DDL](../../sql-statements/data-definition/atomic-ddl.md) and `CREATE SEQUENCE` is atomic.

## Examples

```
CREATE SEQUENCE s START WITH 100 INCREMENT BY 10;

CREATE SEQUENCE s2 START WITH -100 INCREMENT BY -10;
```

The following statement fails, as the increment conflicts with the defaults

```
CREATE SEQUENCE s3 START WITH -100 INCREMENT BY 10;
ERROR 4082 (HY000): Sequence 'test.s3' values are conflicting
```

The sequence can be created by specifying workable minimum and maximum values:

```
CREATE SEQUENCE s3 START WITH -100 INCREMENT BY 10 MINVALUE=-100 MAXVALUE=1000;
```

From [MariaDB 11.5](https://app.gitbook.com/s/aEnK0ZXmUbJzqQrTjFyb/mariadb-community-server-release-notes/old-releases/release-notes-mariadb-11-5-rolling-releases/what-is-mariadb-115):

```
CREATE SEQUENCE s3 AS BIGINT UNSIGNED START WITH 10;
```

Parser accepting larger or smaller values:

```
CREATE OR REPLACE SEQUENCE s AS TINYINT SIGNED
  MINVALUE=-999999999999999999999999999999999
  MAXVALUE=999999999999999999999999999999999 
  START WITH 100 INCREMENT BY 10;
Query OK, 0 rows affected, 2 warnings (0.037 sec)

SHOW WARNINGS;
+-------+------+-----------------------------------------------+
| Level | Code | Message                                       |
+-------+------+-----------------------------------------------+
| Note  | 1292 | Truncated incorrect INTEGER value: 'MINVALUE' |
| Note  | 1292 | Truncated incorrect INTEGER value: 'MAXVALUE' |
+-------+------+-----------------------------------------------+

SELECT * FROM INFORMATION_SCHEMA.SEQUENCES\G
*************************** 1. row ***************************
       SEQUENCE_CATALOG: def
        SEQUENCE_SCHEMA: test
          SEQUENCE_NAME: s
              DATA_TYPE: tinyint
      NUMERIC_PRECISION: 8
NUMERIC_PRECISION_RADIX: 2
          NUMERIC_SCALE: 0
            START_VALUE: 100
          MINIMUM_VALUE: -127
          MAXIMUM_VALUE: 126
              INCREMENT: 10
           CYCLE_OPTION: 0
```

### Cache

Flushing the cache:

```
CREATE OR REPLACE SEQUENCE s START WITH 1 INCREMENT BY 1 MAXVALUE=10 CACHE=5;

SELECT NEXTVAL(s);
+------------+
| NEXTVAL(s) |
+------------+
|          1 |
+------------+

SELECT NEXTVAL(s);
+------------+
| NEXTVAL(s) |
+------------+
|          2 |
+------------+

FLUSH TABLES s;

SELECT NEXTVAL(s);
+------------+
| NEXTVAL(s) |
+------------+
|          6 |
+------------+

FLUSH TABLES s;

SELECT NEXTVAL(s);
ERROR 4084 (HY000): Sequence 'test.s' has run out
```

### Create table with a sequence as a default value

One can use sequences instead of `AUTO_INCREMENT` to generate values for a table

```
create sequence s1;
create table t1 (a int primary key default nextval(s1), b int);
insert into t1 (b) values(1);
select * from t1;
+---+------+
| a | b    |
+---+------+
| 1 |    1 |
+---+------+
```

## See Also

* [Sequence Overview](sequence-overview.md)
* [ALTER SEQUENCE](alter-sequence.md)
* [DROP SEQUENCE](drop-sequence.md)
* [NEXT VALUE FOR](sequence-functions/next-value-for-sequence_name.md)
* [PREVIOUS VALUE FOR](sequence-functions/previous-value-for-sequence_name.md)
* [SETVAL()](sequence-functions/setval.md). Set next value for the sequence.
* [AUTO INCREMENT](../../data-types/auto_increment.md)
* [SHOW CREATE SEQUENCE](../../sql-statements/administrative-sql-statements/show/show-create-sequence.md)
* [Information Schema SEQUENCES Table](../../sql-statements/administrative-sql-statements/system-tables/information-schema/information-schema-tables/information-schema-sequences-table.md)

CC BY-SA / Gnu FDL
