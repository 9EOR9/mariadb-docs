# Configure OpenID Connect Identity Provider

MariaDB Enterprise Manager can be integrated with external identity providers (like Okta, Keycloak, or Azure AD) using OpenID Connect (OIDC). This allows you to centralize user authentication, enforce your organization's security policies, and enable single sign-on (SSO).

{% hint style="info" %}
MariaDB Enterprise Manager provides a built-in user management system for authentication. For organizations that prefer centralized identity management, integrating with an external OpenID Connect (OIDC) Identity Provider such as Keycloak is an optional feature that enables single sign-on (SSO) with your corporate credentials.
{% endhint %}

### Before You Begin

Before you start, you must have the following information from your OIDC Identity Provider:

* **Authentication URL**: The endpoint of your Identity Provider used for authentication requests.
* **Client ID**: The unique identifier for the MariaDB Enterprise Manager application registered with your provider.
* **Client Secret**: The secret key for the MariaDB Enterprise Manager application.

Additionally, you must configure your Identity Provider to pass the user's role in the JWT token, as explained in the "Mapping IDP Roles" section below.

{% stepper %}
{% step %}
### Navigate to Identity Provider Settings

* From the main UI, click the **Settings icon (⚙️)** in the left navigation bar.
* On the Settings page, click the **Identity Provider** card.

<figure><img src="../../../.gitbook/assets/image (29).png" alt=""><figcaption></figcaption></figure>
{% endstep %}

{% step %}
### Enter Your OIDC Provider Details

On the OpenID Connect (OIDC) configuration page, fill in the details from your provider:

* **Authentication URL**: The full URL for your OIDC provider's authentication endpoint.
* **Authentication Flow**: Choose the OIDC flow. `auto` is the default and recommended for most providers.
* **Client ID**: The Client ID you obtained from your provider.
* **Client Secret**: The Client Secret you obtained from your provider.
{% endstep %}

{% step %}
### Save the Configuration

* Click the **Save** button to apply the settings.

<figure><img src="../../../.gitbook/assets/image (30).png" alt=""><figcaption></figcaption></figure>
{% endstep %}
{% endstepper %}

{% hint style="success" %}
**OIDC Using Keycloak**

Here is an example of what the filled-in fields might look like if you are using Keycloak.

* **Authentication URL**: This is the URL to your specific Keycloak realm: `http://<keycloak_ip>:<port>/realms/<your_realm>`
* **Authentication Flow**: The default `auto` flow is recommended for Keycloak.
* **Client ID**: The `Client ID` you configured for the application within your Keycloak realm: `enterprise-manager`
* **Client Secret**: This secret is generated by Keycloak and found in the 'Credentials' tab of your client configuration in the Keycloak admin console: `12345ab-c67d-89e0-f123-456789abcdef`
{% endhint %}

### Mapping IDP Roles to Enterprise Manager Permissions

For Enterprise Manager to assign the correct permissions to a user logging in via OIDC, it expects the JWT token from your provider to contain a specific field (claim) named `account`.

The value of this `account` field must exactly match the name of a role that exists in MariaDB Enterprise Manager (for example, `admin`, `viewer`, or a custom role).

{% hint style="success" %}
**Example JWT payload showing the account claim**

`{`\
`"account": "admin",`\
`"aud": "admin",`\
`"exp": 1760133641,`\
`"iat": 1760104841,`\
`"iss": "maxscale",`\
`"jti": "0780a545-bb7a-404d-a384-64d04557801d",`\
`"sub": "admin"`\
`}`

This token's `account` claim value "admin" would grant the user the admin role upon login.
{% endhint %}

{% stepper %}
{% step %}
Resetting the OIDC Configuration

To restore the default settings:

1.  Click the **Reset Configuration** button.\


    <figure><img src="../../../.gitbook/assets/image (31).png" alt=""><figcaption></figcaption></figure>
2.  In the confirmation dialog, click **Reset**.\


    <figure><img src="../../../.gitbook/assets/image (32).png" alt=""><figcaption></figcaption></figure>
{% endstep %}

{% step %}
A success message will confirm the reset.


{% endstep %}
{% endstepper %}

